enclave {

    from "sgx_pthread.edl" import *;
    from "sgx_tstdc.edl" import *;

    trusted {
        public int ecall_efs_init();
        public int ecall_efs_exit();
    };

    #define BLK_SZ 4096
    untrusted {
        include "../include/types.h"

        int ocall_disk_read([out, size = BLK_SZ] uint8_t *buf, uint32_t bid);

        int ocall_disk_write([in, size = BLK_SZ] uint8_t *buf, uint32_t bid);

        int ocall_log(int log_type, [in, size = len] char *msg, uint32_t len);

        void ocall_panic(int exitcode);
    };
};
